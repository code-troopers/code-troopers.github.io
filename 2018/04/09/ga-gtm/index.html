
<!doctype html>
<html class="no-js" lang="fr-fr" itemscope itemtype="http://schema.org/Organization">
<head>
  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NWLQD2');</script>
  
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Code-Troopers</title>
  <meta name="viewport" content="user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width" />

  <meta property="og:title" content=" Code-Troopers" />
  <meta property="og:site_name" content="Code-Troopers" />
  <meta property="og:url" content="https://code-troopers.com/" />
  <meta property="og:image" content="https://code-troopers.com/images/banner/logo-banner.png"/>


  <meta property="og:type" content="website" />


  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@codetroopers" />
  <meta name="twitter:creator" content="@codetroopers" />
  <meta name="twitter:title" content="Code-Troopers" />
  <meta name="twitter:url" content="https://code-troopers.com/" />


  <meta name="twitter:description" content="Code-Troopers est une agence spécialisée dans le développement logiciel et la conception d’applications mobiles sur-mesure." />
  <meta name="twitter:image" content="https://code-troopers.com/images/banner/logo-banner.png"/>
  <meta name="description" content="Code-Troopers est une agence spécialisée dans le développement logiciel et la conception d’applications mobiles sur-mesure." />
  <meta property="og:description" content="Code-Troopers est une agence spécialisée dans le développement logiciel et la conception d’applications mobiles sur-mesure."/>


  <meta name="p:domain_verify" content="fc173d84e3a4de948ed4bda2908afd3e"/>
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="theme-color" content="#3BCCE5" />


  <link href="https://code-troopers.com/index.xml" rel="alternate" type="application/rss+xml" title="Code-Troopers" />
  <link rel="canonical" href="https://code-troopers.com/" />
  <link rel="shortcut icon" href="../../../../favicon.ico?v=2" type="image/x-icon">
  <link rel="icon" href="../../../../favicon.ico?v=2" type="image/x-icon">
  <meta itemprop="name" content="Code-Troopers"/><link rel="stylesheet" href="../../../../styles.2481.css" /><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
  <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
  <script>
      window.addEventListener("load", function(){
          window.cookieconsent.initialise({
              "palette": {
                  "popup": {
                      "background": "#000"
                  },
                  "button": {
                      "background": "transparent",
                      "text": "#3BCCE5",
                      "border": "#3BCCE5"
                  }
              },
              "content": {
                  "message": "En poursuivant la navigation, vous acceptez l'utilisation de cookies.",
                  "dismiss": "J'ai compris",
                  "link": "En savoir plus"
              }
          })});
  </script>
</head>

<body>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NWLQD2"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



<header>
    <nav>
        <a href="../../../../" class="brand"><img src="../../../../img/Code-Troopers.png" alt="Code-Troopers"></a>
        
            
            <a href="../../../../#skills" class=" "><span>Compétences</span></a>
            
        
            
            <a href="../../../../#portfolio" class=" "><span>Réalisations</span></a>
            
        
            
            <a href="../../../../#casting" class=" "><span>Casting</span></a>
            
        
            
            <a href="../../../../#contact" class=" "><span>Contact</span></a>
            
        
            
            <a href="../../../../blog" class=" active  blog"><span>Blog</span></a>
            
        
            
        
    </nav>
</header>
<section id="blog">
    <div class="wrapper">
        <h1>
            Blog
        </h1>
    </div>

    <section id="article">
        <div class="wrapper">
            <article>
                
                <img src="../../../../images/banner/ga-gtm-banner.png">
                
                
                
                <div class="wrapper-content">
                    <h2>Google Analytics via Google Tag Manager</h2>
                    
                    
                    <ul class="tags">
                        
                        <li><a href="../../../../tags/ga/">GA</a></li>
                        
                        <li><a href="../../../../tags/gtm/">GTM</a></li>
                        
                    </ul>
                    
                    <div class="content">
                        <div class="paragraph">
<p>C&#8217;est en branchant <a href="https://www.facebook.com/business/a/facebook-pixel">Facebook PIXEL</a> sur un projet, que j&#8217;ai enfin compris et vraiment utilisé <strong>Google Tag Manager</strong>.
L&#8217;aide très bien faite de la mise en place de <strong>PIXEL</strong> préconise celui-ci pour activer et configurer le traqueur Facebook et cela m&#8217;a donné envie d&#8217;en faire de même pour <strong>Google Analytics</strong>.</p>
</div>
<div class="paragraph">
<p>Pour ceux qui ne connaissent pas <strong>Google Tag Manager</strong>, c&#8217;est un outil permettant d&#8217;ajouter, modifier des bouts de Javascript (tags) afin de gérer les analytics ou la pub par exemple à l&#8217;aide du back office, et tout ça sans avoir à modifier ou relivrer son application.</p>
</div>
<div class="sect1">
<h2 id="_1ère_étape_configurer_google_tag_manager">1ère étape : Configurer Google Tag Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>C&#8217;est un jeu d&#8217;enfants, il suffit de vous rendre sur l&#8217;interface d&#8217;administration (<a href="https://tagmanager.google.com" class="bare">https://tagmanager.google.com</a>), de créer un conteneur et d&#8217;ajouter deux bouts de code JS dans votre site et c&#8217;est normalement la seule modification qui sera faite dans votre code.
Je ne m&#8217;attarde pas sur cette étape qui est assez simple et déjà très bien documentée.
Pour tester si votre conteneur est bien configuré sur votre site, avec <strong>GTM</strong> vous avez la possibilité de lancer un mode debug avec le bouton <code>PRÉVISUALISER</code>.
Cette action permet d&#8217;ajouter un panel de debug sur votre site dès lors que vous naviguez avec le même navigateur sur le site où le conteneur <strong>GTM</strong> est activé.
Nous reviendrons sur ce panel de debug par la suite.</p>
</div>
<div class="paragraph">
<p><div style="text-align : center">
<a style="display: inline" href="../../../../images/posts/2018-03-22_GA-GTM/debug_panel.png" data-lightbox="0" title="Panel de debug">
        <img class="medium" src="../../../../images/posts/2018-03-22_GA-GTM/debug_panel_min.png" alt="Panel de debug"/>
</a>
</div>
<br/></p>
</div>
<div class="paragraph">
<p><strong>Google Tag Manager</strong> se découpe en trois grandes parties :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>les balises (<em>tag</em>) : une balise représente du code Javascript que l&#8217;on va pousser et exécuter dans notre conteneur.</p>
</li>
<li>
<p>les déclencheurs (<em>triggers</em>) : les déclencheurs sont des conditions permettant de pousser ou non nos balises.</p>
</li>
<li>
<p>les variables sont ce qu&#8217;on pourra interpréter dans notre balise. Il y en a certaines déjà définies et d&#8217;autres que l&#8217;on peut construire.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pour ajouter <strong>Google Analytics</strong> à notre application, il va falloir utiliser ces trois composants.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2ème_étape_ajouter_google_analytics">2ème étape : Ajouter Google Analytics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Normalement pour ajouter <strong>Google Analytics</strong> à votre application, vous auriez dû (de la même manière qu&#8217;on a ajouté <strong>GTM</strong> juste avant), suivre les instructions de <strong>Google Analytics</strong> à la création du projet sur celui-ci et copier-coller un bout de code pour l&#8217;activer.
Mais vous l&#8217;avez compris, ce n&#8217;est pas ce qu&#8217;il va se passer vu qu&#8217;on ne va plus toucher au code.
Premièrement, vous devez quand même créer le projet sur <a href="https://analytics.google.com/" class="bare">https://analytics.google.com/</a> et garder dans un coin le <code>trackingId</code>, ensuite, tout se passe dans <strong>Google Tag Manager</strong>.</p>
</div>
<div class="paragraph">
<p>Le principe premier de <strong>Google Analytics</strong> est de traquer les différentes pages consultées par l&#8217;utilisateur.
Cette information se trouve normalement dans la variable <code>Page Path</code> qui fait partie des variables activées par défaut à la création du conteneur.
Mais si, comme nous, vous faites beaucoup d'<strong>Angular</strong>, vous avez à faire avec des urls du type <code><a href="http://localhost:9000/#/home" class="bare">http://localhost:9000/#/home</a></code>.
Vous savez que ce n&#8217;est pas aussi simple et vous avez déjà dû vous retrouver à mettre ce genre de code pour traquer exactement la page visualisée et pas tout le temps <code>/</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="javascript"><span></span>  <span class="tok-k">this</span><span class="tok-p">.</span><span class="tok-nx">router</span><span class="tok-p">.</span><span class="tok-nx">events</span><span class="tok-p">.</span><span class="tok-nx">subscribe</span><span class="tok-p">((</span><span class="tok-nx">event</span><span class="tok-p">)</span> <span class="tok-p">=&gt;</span> <span class="tok-p">{</span>
            <span class="tok-k">if</span> <span class="tok-p">(</span><span class="tok-nx">event</span> <span class="tok-k">instanceof</span> <span class="tok-nx">NavigationEnd</span><span class="tok-p">)</span> <span class="tok-p">{</span>
                <span class="tok-nx">ga</span><span class="tok-p">(</span><span class="tok-s1">&#39;set&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;page&#39;</span><span class="tok-p">,</span> <span class="tok-nx">event</span><span class="tok-p">.</span><span class="tok-nx">urlAfterRedirects</span><span class="tok-p">);</span>
                <span class="tok-nx">ga</span><span class="tok-p">(</span><span class="tok-s1">&#39;send&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;pageview&#39;</span><span class="tok-p">);</span>
            <span class="tok-p">}</span>
        <span class="tok-p">});</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour répondre à ce problème avec <strong>Google Tag Manager</strong>, il faut activer une nouvelle variable <code>New History Fragment</code> se basant sur l&#8217;API History du navigateur pour stocker la valeur de la nouvelle page.
Pour faire cela, vous avez juste à cliquer sur <code>Variables</code> dans le menu, puis <code>CONFIGURER</code> et enfin cocher <code>New History Fragment</code>.</p>
</div>
<div class="paragraph">
<p>Afin d&#8217;envoyer un nouvel évènement à chaque changement de page, nous devons déclarer un nouveau déclencheur se basant sur l&#8217;API History. Pour cela, cliquez sur le menu <code>Déclencheurs</code>, puis <code>NOUVEAU</code>.
À ce moment vous devez cocher l&#8217;item <code>History Change</code> dans la liste s&#8217;affichant lorsque vous cliquez dans le cadre blanc.</p>
</div>
<div class="paragraph">
<p>Enfin, vous n&#8217;avez plus qu&#8217;à créer votre balise <code>Analytics</code>.
Pour cela rendez-vous dans le menu <code>Balises</code>, lorsque vous cliquez sur <code>NOUVELLE</code>, vous pouvez sélectionner le type de balise <code>Universal Analytics</code> dans le premier cadre et votre déclencheur préalablement créé dans le deuxième.
Il reste deux informations à configurer, le tracking id que vous pouvez ajouter en configurant une nouvelle variable dans <code>Google Analytics Settings</code> et la modification pour prendre en compte votre variable se basant sur l&#8217;API History.
Il faut cocher <code>Enable overriding settings in this tag</code>, déplier <code>More settings</code> et <code>Fields to Set</code> et ajouter un champ <code>page</code> correspondant à la valeur <code>{{New History Fragment}}</code> (nom de votre variable créée).</p>
</div>
<div class="paragraph">
<p>À partir de là notre conteneur est bien configuré il n&#8217;y a plus qu&#8217;à tester et livrer.
 Pour ce faire, vous devez activer le mode debug en cliquant sur <code>PRÉVISUALISER</code> si ce n&#8217;est pas déjà fait et lancer votre application.
 Dans le panel de debug, vous verrez normalemement la liste des différents <code>déclencheurs</code> sur la gauche, et lorsque vous cliquez dessus, vous pouvez voir quelles balises ont été activées et dans l&#8217;onglet <code>Variables</code>, la valeur des différentes variables (dont votre <code>New History Fragment</code>).</p>
</div>
<div class="paragraph">
<p><div style="text-align : center">
<a style="display: inline" href="../../../../images/posts/2018-03-22_GA-GTM/debug_panel_1.png" data-lightbox="0" title="Panel de debug">
        <img class="medium" src="../../../../images/posts/2018-03-22_GA-GTM/debug_panel_1_min.png" alt="Panel de debug"/>
</a>
</div>
<br/></p>
</div>
<div class="paragraph">
<p>Il ne reste plus qu&#8217;à publier vos modifications pour qu&#8217;elles soient actives sur tous vos environnements en cliquant sur <code>ENVOYER</code> et <code>PUBLIER</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_avantages_de_gtm">Avantages de GTM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GTM propose de multiples fonctionnalités à travers les balises, les déclencheurs et les variables.
Vous pouvez :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>déclarer un tableau de variables qui seront différentes suivant les environnements (en se basant sur l&#8217;url).</p>
</li>
<li>
<p>récupérer des valeurs de votre site grâce à des règles CSS afin de les pousser par exemple vers GA et tout ça sans avoir à relivrer votre application.</p>
</li>
<li>
<p>ajouter facilement une connexion vers <strong>AdWords</strong>, <strong>Google Optimize</strong> et pleins d&#8217;autres services.</p>
</li>
</ul>
</div>
</div>
</div>

                    </div>
                    <div class="content-footer">
                        
                        <ul class="tags float">
                            
                            <li><a href="../../../../tags/ga/">GA</a></li>
                            
                            <li><a href="../../../../tags/gtm/">GTM</a></li>
                            
                        </ul>
                        
                        <section id="author">
                            <div class="date">Rédigé par <span class="author-name">Benjamin</span></div>
                        </section>
                    </div>
                    <div class="share">
                        <span>Partager</span>
                        <ul class="socials">
                            <li>
                                <a target="_blank" title="Facebook"
                                   href="https://www.facebook.com/sharer.php?u=http://code-troopers.com%2f2018%2f04%2f09%2fga-gtm%2f&t=Google%20Analytics%20via%20Google%20Tag%20Manager"
                                   class="facebook-button" rel="nofollow"
                                   onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;">
                                    <i class="fa fa-facebook"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" title="Twitter"
                                   href="https://twitter.com/share?url=http://code-troopers.com%2f2018%2f04%2f09%2fga-gtm%2f&text=Google%20Analytics%20via%20Google%20Tag%20Manager&via=codetroopers"
                                   rel="nofollow"
                                   onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;">
                                    <i class="fa fa-twitter"></i>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" title="Google +"
                                   href="https://plus.google.com/share?url=http://code-troopers.com%2f2018%2f04%2f09%2fga-gtm%2f&hl=fr"
                                   class="google-button" rel="nofollow"
                                   onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;">
                                    <i class="fa fa-google-plus"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div style="clear:both"></div>


                    <div class="back">
                        <div class="pagination">
                            
                            <a href="../../../../2018/04/27/android-demo-mode/" class="previous-page">
                                <div class="arrow"><div class="arrow_box_left arrow_box">
</div></div>
                                Article précédent
                            </a>
                            
                            
                            <a href="../../../../2018/03/16/firebase-xcode-plist/" class="next-page">
                                Article suivant
                                <div class="arrow"><div class="arrow_box_right arrow_box">
</div></div>
                            </a>
                            
                        </div>
                    </div>

                    <section id="menu">
                        <ul>
                            
                        </ul>
                    </section>

                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                         
                        var disqus_shortname = 'codetroopers' 
                        var disqus_url = window.location.href
                        if (window.location.protocol != 'http:') {
                            disqus_url = 'http:' + window.location.href.substring(window.location.protocol.length)
                        }

                         
                        (function () {
                            var dsq = document.createElement('script')
                            dsq.type = 'text/javascript'
                            dsq.async = true
                            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq)
                        })()
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments
                        powered by Disqus.</a></noscript>
                    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span
                            class="logo-disqus">Disqus</span></a>
                </div>
            </article>
        </div>
    </section>
</section>

<section id="contact">
    <h1>Contact</h1>


    <div>
        <div><iframe class="lozad"
                    width="100%"
                    height="100%"
                    frameborder="0" style="border:0"
                    data-src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDmneK7ppr9MWdY2ynnTXsnhEloW2r7GzQ&q=Code-Troopers,+37000+Tours+France&zoom=15">
            </iframe></div>
        <div>
            <h2>Code-Troopers</h2>
            <p>
                <strong>MAME</strong><br>
                Cité de la création et du numérique<br>
                49 boulevard Preuilly<br>
                37000 Tours - Fr
            </p>
            <p>
                <a href="mailto:contact@code-troopers.com">contact@code-troopers.com</a>
            </p>
            <p>
                <a class="button" href="tel:+33782287216">07 82 28 72 16</a>
            </p>
        </div>
    </div>

    <h1>Suivez nos actualités</h1>

    <ul class="flex">
        <li>
            <a href="https://facebook.com/codetroopers37">
                <i class="fa fa-facebook fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="https://twitter.com/codetroopers">
                <i class="fa fa-twitter fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="https://plus.google.com/+Code-troopers">
                <i class="fa fa-google-plus fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="https://github.com/code-troopers">
                <i class="fa fa-github fa-3x fa-fw"></i>
            </a>
        </li>
        <li>
            <a href="../../../../index.xml">
                <i class="fa fa-rss fa-3x fa-fw"></i>
            </a>
        </li>
    </ul>
</section>

<footer>
    <div class="wrapper">
        <a href="#top" class="scroll-to-top">
            <img class="arrow" src="../../../../img/arrow.png" alt="arrow">
        </a>
        <img src="../../../../img/footer_logo.png" alt="logo">
        <div>
            <span>©2014 — 2018 Code-Troopers | <a href="../../../../legals.html">Mentions légales</a></span>
            <span>Design : <a href="https://www.descheval.com/">descheval.com</a> | Développement : Code-Troopers</span>
        </div>
    </div>
</footer>
<script type="application/javascript" src="../../../../main.a8165d.js"></script>

<script type="application/javascript" src="../../../../blog.6bad53.js"></script>

</body>
</html>

